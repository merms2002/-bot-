const handler = async (m, {conn}) => {
  try {
    m.react("ğŸ“°");
    
    const res = await fetch("https://the-end-api.vercel.app/home/sections/Search/api/anime/news");
    const {data} = await res.json();
    
    if (!data) throw new Error("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø¨Ø§Ø± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹");

    let message = `
*ã€˜ â”â”â”â”â”â” âœ¦ â”â”â”â”â”â” ã€™*
       ã€ ğŸ“° ğ—”ğ—¡ğ—œğ— ğ—˜ ğ—¡ğ—˜ğ—ªğ—¦ ã€
*ã€˜ â”â”â”â”â”â” âœ¦ â”â”â”â”â”â” ã€™*\n\n`;

    for (const [animeName, newsItems] of Object.entries(data)) {
      message += `*ğŸŒ ${animeName.trim()}*\n`;
      
      newsItems.forEach(news => {
        message += `
ğŸ†” *ID âŠ³ :* ${news.id}
ğŸ“Œ âŠ³ *Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:* ${news.title}
ğŸ“…  âŠ³ *Ø§Ù„ØªØ§Ø±ÙŠØ®:* ${news.date}
ğŸ“  âŠ³ *Ø§Ù„ÙˆØµÙ:* ${news.description}
ğŸ–¼ï¸  âŠ³ *Ø§Ù„ØµÙˆØ±Ø©:* ${news.thumbnail}
ğŸ”— âŠ³ *Ø§Ù„Ø±Ø§Ø¨Ø·:* ${news.url}
${'â•'.repeat(30)}\n`;
      });
    }

    message += `\n*ğŸ“Š Ù„Ù‚ÙŠÙ†Ø§Ù„Ùƒ :* ${Object.values(data).flat().length} Ø®Ø¨Ø±`;
    message += `\n*â±ï¸ Ø¢Ø®Ø± Ù…Ø±Ù‡ Ø­Ø§Ø¬Ù‡ Ù†Ø²Ù„Øª ÙƒØ§Ù†Øª ÙØªØ§Ø±ÙŠØ®:* ${new Date().toLocaleString()}`;

    await conn.sendMessage(m.chat, {text: message}, {quoted: m});
    m.react("âœ…");

  } catch (error) {
    m.reply(`âŒ Ø®Ø·Ø£: ${error.message}`);
    m.react("âŒ");
  }
};

handler.help = ['animenews'];
handler.tags = ['anime'];
handler.command = /^(Ø§Ø®Ø¨Ø§Ø±-Ø§Ù†Ù…ÙŠ|Ø§Ù†Ù…ÙŠ-Ø§Ø®Ø¨Ø§Ø±|animenews)$/i;
export default handler;